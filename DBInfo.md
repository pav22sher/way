###Базы данных

> База данных (БД) — набор сведений, хранящихся некоторым упорядоченным способом.

> Система управления базами данных (СУБД) — совокупность языковых и программных средств,
> предназначенных для создания, наполнения, обновления и удаления баз данных.

СУБД: 
* MySQL 
* Oracle 
* PostgreSQL

> Часто мы говорим БД, хотя имеем в веду СУБД.

> Данные — это набор конкретных значений, параметров,
> характеризующих объект, условие, ситуацию или любые другие факторы.

> Модель данных — это некоторая абстракция, которая позволяет пользователям
> и разработчикам трактовать их уже как информацию,
> содержащую не только данные, но и взаимосвязь между ними.

В зависимости от вида организации данных различают следующие модели БД:
* иерархическую
* сетевую
* реляционную
* объектно-ориентированную

###Реляционные базы данных

> Реляционная база данных (БД) — это совокупность связанных между собой двумерных таблиц, 
> в которых хранится информация об объектах.
> Понятие «реляционный» основано на англ. relation («отношение, зависимость, связь»). 

> Отношение — это двумерная таблица с уникальным именем. 
> Она состоит из строк (кортежей) и столбцов (атрибутов).

> Первичный ключ (сокращенно РК - primary key) - столбец, значения которого во всех строках различны.
> Первичным ключом называется поле или набор полей, однозначно идентифицирующих запись.
> Первичные ключи могут быть логическими (естественными) и суррогатными (искусственными).

> Внешний ключ (сокращенно FК - foreign key) – это ограничение, которое поддерживает согласованное 
> состояние данных между двумя таблицами, обеспечивая так называемую ссылочную целостность.
> Этот тип целостности означает, что всегда есть возможность получить полную информацию об объекте, 
> распределенную по нескольким таблицам.

Существует три типа связей между таблицами:
* Один к одному — каждая запись одной таблицы связана только с одной записью другой.
* Один ко многим — каждая запись одной таблицы связана с одной или несколькими записями другой.
* Многие ко многим — несколько записей одной таблицы связаны с несколькими записями другой.

Основные типы данных:
* int
* bigint
* smallint
* decimal
* numeric
* char
* varchar
* text
* date
* time
* datetime

> Ограничения (constraints) — это правила, применяемые к данным. 
> Они используются для ограничения данных, которые могут быть записаны в таблицу. 
> Это обеспечивает точность и достоверность данных в БД.

Constraints:
* PRIMARY KEY — первичный ключ (уникальный идентификатор записи в текущей таблице)
* FOREIGN KEY — внешний ключ (уникальный идентификатор записи в другой таблице)
* NOT NULL — колонка не может иметь нулевое значение
* UNIQUE — все значения колонки должны быть уникальными
* DEFAULT — значение колонки по умолчанию
* CHECK — все значения в колонке должны удовлетворять определенному условию

###SQL

> SQL(Structured Query Language) - это язык структурированных запросов, позволяющий хранить, 
> манипулировать и извлекать данные из реляционных баз данных.

SQL:
* DDL — язык определения данных (Data Definition Language)
* DML — язык изменения данных (Data Manipulation Language
* DCL — язык управления данными (Data Control Language)
* TCL — язык управления транзакциями (Transaction Control Language)

###DDL

DDL операторы:
* CREATE – используется для создания объектов базы данных
* ALTER – используется для изменения объектов базы данных
* DROP – используется для удаления объектов базы данных

###DML

DML операторы:
* SELECT – осуществляет выборку данных
* INSERT – добавляет новые данные
* UPDATE – изменяет существующие данные
* DELETE – удаляет данные

###DCL

DCL операторы:
* GRANT – предоставляет пользователю или группе разрешения на определённые операции с объектом БД
* REVOKE – отзывает выданные разрешения

###TCL

TCL операторы:
BEGIN TRANSACTION – начала транзакции
COMMIT TRANSACTION – фиксирует транзакцию
SAVE TRANSACTION – устанавливает промежуточную точку сохранения внутри транзакции
ROLLBACK TRANSACTION – откатывает все изменения, сделанные в текущей транзакции до точки сохранения

###Встроенные функции

Встроенных функций для работы со строками:
* CONCAT — объединение строк
* LENGTH — возвращает количество символов в строке
* TRIM — удаляет пробелы в начале и конце строки
* SUBSTRING — извлекает подстроку из строки
* REPLACE — заменяет подстроку в строке
* LOWER — переводит символы строки в нижний регистр
* UPPER — переводит символы строки в верхний регистр

Встроенных функций для работы с числами:
ROUND — округляет число
TRUNCATE — обрезает дробное число до указанного количества знаков после запятой
CEILING — округляет вещественное число(возвращает наименьшее целое число)
FLOOR — округляет вещественное число(возвращает наибольшее целое число)
POWER — возводит число в указанную степень
SQRT — возвращает квадратный корень числа
RAND — генерирует случайное число с плавающей точкой в диапазоне от 0 до 1

Встроенных функций для работы с датой и временем:
* DAYOFMONTH(date) — возвращает день месяца в виде числа
* DAYOFWEEK(date) — возвращает день недели в виде числа
* DAYOFYEAR(date) — возвращает номер дня в году
* MONTH(date) — возвращает месяц
* YEAR(date) — возвращает год
* LAST_DAY(date) — возвращает последний день месяца в виде даты
* HOUR(time) — возвращает час
* MINUTE(time) — возвращает минуты
* SECOND(time) — возвращает секунды
* DATE_ADD(date, interval) — выполняет сложение даты и определенного временного интервала
* DATE_SUB(date, interval) — выполняет вычитание из даты определенного временного интервала
* DATEDIFF(date1, date2) — возвращает разницу в днях между двумя датами

###Транзакции

> Транзакция – это последовательность действий с БД, в которой либо все действия выполняются успешно,
> либо не выполняется ни одно из них.
> Транзакция является атомарной (англ. atomic), она выполняется как единое целое.

> MVCC (Multi-Version Concurrency Control) - это механизм управления параллелизмом,
> используемый в базе данных для управления параллельным выполнением транзакций
> и контроля изоляции транзакций.

> В базах данных и обработке транзакций двухфазная блокировка (2PL) — 
> это метод управления параллелизмом, который гарантирует сериализуемость. 

> 2PL работает так: 
> когда транзакция приходит с тем, чтобы изменить какую либо запись, она устанавливает блокировку
> на запись и ждет, пока все блокировки на запись и на чтение, установленные ранее, будут сняты.
> После этого, транзакция вносит свои изменения и убирает установленную ею блокировку. 
> Если же транзакция пришла с тем, чтобы прочитать запись, она устанавливает блокировку на чтение 
> и ждет, пока все блокировки на запись, установленные ранее, будут сняты. 
> После этого транзакция вычитывает нужные ей данные и снимает установленную блокировку.

> Эскалация блокировок – механизм повышения области блокировки. 
> Основная задача эскалации состоит в повышение производительность 
> при очень большом количестве блокировок за счет укрупнения области блокировки. 

> База данных может посчитать, что вместо того, чтобы заблокировать много строк, 
> ей будет дешевле заблокировать страницу/индекс/таблицу/базу данных. 
> Это и называется эскалация блокировки.

Типы блокировок:
* Shared Lock - разделяемая блокировка, которая используется при выполнении операции чтения данных.
  Shared Lock позволяет читать данные другим транзакциям, но запрещает изменять данные.
* Exclusive Lock - эксклюзивная(монопольная) блокировка, которая применяется при изменении данных.
  Exclusive Lock полностью запрещает доступ к данных другим транзакциям.
* Update Lock - блокировка обновления, которая является промежуточной между разделяемой 
  и эксклюзивной блокировкой. В этом случае другим транзакциям 
  разрешается устанавливать разделяемые блокировки, но не позволяет устанавливать эксклюзивные.
  
Уровни блокировок:
* Уровень строк
* Уровень страницы
* Уровень таблицы

> Транзакции обладают четырьмя следующими свойствами ACID:
> Atomicity, Consistency, Isolation, Durability

###ACID

ACID:
Atomicity — транзакции атомарны, то есть либо все изменения транзакции фиксируются (commit), либо все откатываются (rollback);
Consistency — транзакции не нарушают согласованность данных, то есть они переводят базу данных из одного корректного состояния в другое. Тут можно упомянуть допустимые значения полей, внешние ключи и более сложные ограничения целостности;
Isolation — работающие одновременно транзакции не влияют друг на друга, то есть многопоточная обработка транзакций производится таким образом, чтобы результат их параллельного исполнения соответствовал результату их последовательного исполнения;
Durability — если транзакция была успешно завершена, никакое внешнее событие не должно привести к потере совершенных ей изменений.

Эффекты при параллельном доступе к данным:
* Эффект потерянного обновления возникает, когда несколько транзакций обновляют одни и те же данные,
  не учитывая изменений, сделанных другими транзакциями.
* Эффект грязного чтения возникает, когда транзакция считывает данные,
  которые еще не были зафиксированы.
* Эффект неповторяемого чтения возникает, когда транзакция считывает дважды одну и ту же строку, 
  но каждый раз получает разные результаты.
* Эффект чтения фантомов возникает, когда набор данных соответствует условиям поиска,
  но изначально не отображается.

Уровни изоляции:
* Чтение не фиксированных данных (Read Uncommitted)
* Чтение фиксированных данных (Read Committed)
* Повторяемое чтение (Repeatable Read)
* Упорядоченное чтение (Serializable)

[Первый источник знаний](https://habr.com/ru/post/564390/)
[Второй источник знаний](https://info-comp.ru/what-is-ddl-dml-dcl-tcl)
